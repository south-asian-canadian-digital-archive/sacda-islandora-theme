{#
/**
 * @file
 * Theme override for Solr Search Content view - individual result.
 *
 * Shows: image, title, and member_of field.
 */
#}
{% set theme_path = '/' ~ active_theme_path() %}
{% set default_image = default_collection_image|default(theme_path ~ '/static/collections/default.jpg') %}

{% set title_field = fields.title.content|default('') %}
{% set member_of_field = fields.member_of_title.content|default('') %}

{# Get image content from various possible field names #}
{% set image_content = fields.did_image.content|default(fields.field_image.content|default(fields.thumbnail.content|default(''))) %}

{# Convert to string and check if content contains an actual image tag #}
{% set image_string = image_content|render|raw %}
{% set display_has_image = '<img' in image_string or 'img' in image_string %}

{# Wrapper with group for hover effects #}
<div class="group cursor-pointer">
	{# Image Container #}
	<div class="aspect-square bg-muted overflow-hidden [&_a]:block [&_a]:w-full [&_a]:h-full [&_img]:w-full [&_img]:h-full [&_img]:object-contain [&_img]:object-center [&_img]:transition-transform [&_img]:duration-300 group-hover:[&_img]:scale-105">
		{% if display_has_image %}
			{{ image_content|raw }}
		{% else %}
			<img src="{{ default_image }}" alt="{{ 'No image'|t }}" class="w-full h-full object-contain transition-transform duration-300 group-hover:scale-105">
		{% endif %}
	</div>

	{# Info section #}
	<div class="py-2.5">
		<div class="text-sm leading-tight mb-1 [&_a]:text-foreground [&_a]:inline-block group-hover:[&_a]:underline group-hover:[&_a]:decoration-primary [&_a]:transition-colors">
			{{ title_field|raw }}
		</div>
		{% if member_of_field|striptags|trim %}
			<div class="text-xs text-muted-foreground">
				{{ member_of_field|striptags|trim }}
			</div>
		{% endif %}
	</div>
</div>
